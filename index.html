<!doctype html><html lang="en" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta property="PublishFilesPath" content="https://anytype-prod-publishserver.s3.eu-central-2.amazonaws.com/67accb61888bdb1bed39e762"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta property="og:title" content="On Dependent and Linear Types"><meta property="og:type" content="website"><meta property="og:url" content=""><meta property="og:image" content=""><meta property="og:description" content="A dependent or linear type system can reason about array lengths that are unknown at compile time using a few different techniques, depending on the language and type system used. Here are some approaches:
Indexed Types &amp; Dependent Types
In dependently typed languages like Idris, Agda, or F*, you …"><meta property="og:site_name" content="Anytype"><meta property="og:locale" content="en_US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="On Dependent and Linear Types"><meta name="twitter:description" content="A dependent or linear type system can reason about array lengths that are unknown at compile time using a few different techniques, depending on the language and type system used. Here are some approaches:
Indexed Types &amp; Dependent Types
In dependently typed languages like Idris, Agda, or F*, you …"><meta name="twitter:image" content=""><meta name="twitter:url" content=""><meta name="twitter:site" content=""><meta name="twitter:creator" content=""><title>On Dependent and Linear Types</title><link rel="apple-touch-icon" sizes="180x180" href="https://anytype.io/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://anytype.io/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://anytype.io/favicon-16x16.png"><style type="text/css">
				#root-loader { position: fixed; width: 100%; height: 100%; left: 0px; top: 0px; background: #fff; z-index: 1000; transition: opacity 0.3s ease-in-out; }
				#root-loader .inner { 
					width: 120px; text-align: center; position: absolute; transform: translate3d(-50%,-50%,0px); display: flex; flex-direction: column; gap: 6px 0px;
					left: 50%; top: 50%;
				}
				#root-loader .anim { opacity: 1; transform: scale3d(1,1,1); transition-duration: 0.3s; transition-property: opacity, transform; transition-timing-function: ease-in-out; }
				#root-loader .anim.from { opacity: 0; transform: scale3d(0.8,0.8,1); }
				#root-loader .anim.to { opacity: 0; transform: translate3d(0px,-20px,0px); }
				#root-loader .logo { width: 120px; height: 24px; background: url('/static/img/logo.svg') no-repeat; background-size: 100%; }
				#root-loader.hide { opacity: 0; }
			</style></head><body><div class="menus"><div id="menu-more" class="menuWrap"><div class="menu vertical"><div class="content"><a id="reportButton" class="item textColor textColor-red" href="mailto:support@anytype.io?subject=Web Publishing Report&amp;body=PublishFilesPath: https://anytype-prod-publishserver.s3.eu-central-2.amazonaws.com/67accb61888bdb1bed39e762"><span class="name">Report</span></a></div></div><div class="dimmer"></div></div></div><main><div id="root-loader"><div class="inner"><div class="logo anim from"></div></div></div><header class="header"><div class="icon more withBackground menuButton" data-menu-id="more" data-horizontal="right"></div></header><div class="coverWrapper"></div>
		<style> 
			.blocks {
				width: max(60%, min(calc(100% - 96px), calc(60% + (100% - 60% - 96px) * 0.000000)));
			}
		</style> 
	<div id="blocks" class="blocks layoutAlign2 withIcon isPage"><div id="" class="block blockIcon"><div class="content"><div class="iconObject c96"><img src="https://anytype-static.fra1.cdn.digitaloceanspaces.com/emojies/1f9f1.png" class="smileImage c56"></div></div><div class="children"></div></div><div><div id="block-header" class="block blockLayout layoutHeader align0" data-width="0.00"><div class="content"></div><div class="children"><div id="block-title" class="block blockText textTitle align2"><a name="block-title"></a> <div class="content"><div class="flex"><div class="text">On Dependent and Linear Types</div></div></div><div class="children"></div></div><div id="featuredRelations" class="block align2 blockFeatured"><div class="content"><div class="wrap"><div class="cell   c-date"><div class="cellContent  c-date"><div class="name">12 Feb 2025</div></div><div class="bullet"></div></div><div class="cell  last c-select"><div class="cellContent last c-select"><div class="wrap"><div class="over"><div class="element"><div class="flex"><div class="tagItem isMultiSelect tagColor-yellow"><div class="inner">types</div></div></div></div></div></div></div><div class="bullet"></div></div></div></div><div class="children"></div></div></div></div><div id="block-67acc0d50e5b17b32eebe7ff" class="block blockTableOfContents "><div class="content"><div class="wrap"><div class="item" style="padding-left:0px;"><a href="#block-67acac980e5b17b32eebe664">Indexed Types &amp; Dependent Types</a></div><div class="item" style="padding-left:0px;"><a href="#block-67acac980e5b17b32eebe66c">Linear Types for Safe Modification</a></div><div class="item" style="padding-left:0px;"><a href="#block-67acac980e5b17b32eebe671">Refinement Types for Runtime Length Constraints</a></div><div class="item" style="padding-left:0px;"><a href="#block-67acac980e5b17b32eebe676">Combining Linear &amp; Dependent Types</a></div><div class="item" style="padding-left:0px;"><a href="#block-67acac980e5b17b32eebe679">Conclusion</a></div><div class="item" style="padding-left:0px;"><a href="#block-67acadaa0e5b17b32eebe691">Links</a></div><div class="item" style="padding-left:0px;"><a href="#block-67acbfbf0e5b17b32eebe73e">APPENDIX A: How rust is related to linear and dependent types?</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acbfaf0e5b17b32eebe718">Linear Types and Safe Indexing in Rust</a></div><div class="item" style="padding-left:48px;"><a href="#block-67acbfaf0e5b17b32eebe71c">How This Relates to Indexing</a></div><div class="item" style="padding-left:48px;"><a href="#block-67acbfaf0e5b17b32eebe71f">Example: Linear-Type-Like Behavior in Rust</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acbfaf0e5b17b32eebe723">Dependent Types and Length-Safe Indexing</a></div><div class="item" style="padding-left:48px;"><a href="#block-67acbfaf0e5b17b32eebe725">Simulating Dependent Types with arrayvec</a></div><div class="item" style="padding-left:48px;"><a href="#block-67acbfaf0e5b17b32eebe72a">Using generic-array for Compile-Time Lengths</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acbfaf0e5b17b32eebe72e">Could Rust Have Built-in Dependent or Linear Types?</a></div><div class="item" style="padding-left:0px;"><a href="#block-67acbfaf0e5b17b32eebe733">APPENDIX B: Existential types</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc0a00e5b17b32eebe7d5">Existential Quantification: What Is It?</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc0a00e5b17b32eebe7d9">Existential Quantification in Type Theory</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc0a00e5b17b32eebe7df">Existential Types in Programming</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc0a00e5b17b32eebe7e1">Example: Existential Quantification in Rust (Trait Objects)</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc0a00e5b17b32eebe7e6">Existential Quantification and Arrays of Unknown Length</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc0a00e5b17b32eebe7ea">Example in Idris (Explicit Existential Types)</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc0a00e5b17b32eebe7ef">Rust Equivalent (Tuple as Existential Pair)</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc14a0e5b17b32eebe8be">Existential Types in Dependent Typed Languages</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc14a0e5b17b32eebe8c1">Existential Types vs. Universal Types</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc14a0e5b17b32eebe8c8">Existential Types in Dependent Languages</a></div><div class="item" style="padding-left:48px;"><a href="#block-67acc14a0e5b17b32eebe8ca">Example: Existential Types in Idris</a></div><div class="item" style="padding-left:48px;"><a href="#block-67acc14a0e5b17b32eebe8d0">Usage Example</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc14a0e5b17b32eebe8d4">Existential Types for Safe Runtime-Length Arrays</a></div><div class="item" style="padding-left:48px;"><a href="#block-67acc14a0e5b17b32eebe8d6">Example: Safely Constructing a Length-Unknown Array</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc14a0e5b17b32eebe8dd">Existential Types in Coq (Σ-Types)</a></div><div class="item" style="padding-left:48px;"><a href="#block-67acc14a0e5b17b32eebe8e0">Example Usage in Coq</a></div><div class="item" style="padding-left:24px;"><a href="#block-67acc14a0e5b17b32eebe8e6">How Existential Types Help with Arrays of Unknown Length</a></div></div></div></div><div id="block-div-67acbfaf0e5b17b32eebe735" class="block blockLayout layoutDiv align0" data-width="0.00"><div class="content"></div><div class="children"><div id="block-67acac980e5b17b32eebe663" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe663"></a> <div class="content"><div class="flex"><div class="text">A dependent or linear type system can reason about array lengths that are unknown at compile time using a few different techniques, depending on the language and type system used. Here are some approaches:</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe664" class="block blockText textHeader3 align0"><a name="block-67acac980e5b17b32eebe664"></a> <div class="content"><div class="flex"><div class="text">Indexed Types &amp; Dependent Types</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe665" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe665"></a> <div class="content"><div class="flex"><div class="text">In dependently typed languages like <markupbold>Idris, Agda, or F</markupbold>*, you can express arrays (or vectors) as types indexed by their length. This allows the type system to track the exact size of an array, even if it&#39;s computed dynamically.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe666" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe666"></a> <div class="content"><div class="flex"><div class="text">For example, in <markupbold>Idris</markupbold>:</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe667" class="block blockText textCode align0"><a name="block-67acac980e5b17b32eebe667"></a> <div class="content"><div class="flex"><div class="text" data-lang="idris">data Vect : Nat -&gt; Type -&gt; Type where
    Nil  : Vect 0 a
    (::) : a -&gt; Vect n a -&gt; Vect (S n) a

</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe668" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe668"></a> <div class="content"><div class="flex"><div class="text">Here, <markupcode>Vect n a</markupcode> represents a vector of <markupcode>n</markupcode> elements of type <markupcode>a</markupcode>. While this works well for statically known lengths, runtime-sized arrays require <markupbold>existential quantification</markupbold> or <markupbold>refinement types</markupbold>.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe669" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe669"></a> <div class="content"><div class="flex"><div class="text">A common trick is to return a <markupbold>dependent pair</markupbold> <markupcode>(n, Vect n a)</markupcode>, where <markupcode>n</markupcode> is computed at runtime:</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe66a" class="block blockText textCode align0"><a name="block-67acac980e5b17b32eebe66a"></a> <div class="content"><div class="flex"><div class="text" data-lang="idris">(Array, length) : (n : Nat ** Vect n a)

</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe66b" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe66b"></a> <div class="content"><div class="flex"><div class="text">This allows reasoning about array lengths dynamically.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe66c" class="block blockText textHeader3 align0"><a name="block-67acac980e5b17b32eebe66c"></a> <div class="content"><div class="flex"><div class="text">Linear Types for Safe Modification</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe66d" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe66d"></a> <div class="content"><div class="flex"><div class="text">In languages with <markupbold>linear types</markupbold>, such as Rust (via ownership), Haskell with <markupbold><markupcode>LinearTypes</markupcode></markupbold><markupbold> extension, or Idris 2</markupbold>, arrays can be safely resized while maintaining guarantees about their length.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe66e" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe66e"></a> <div class="content"><div class="flex"><div class="text">For example, in Rust:</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe66f" class="block blockText textCode align0"><a name="block-67acac980e5b17b32eebe66f"></a> <div class="content"><div class="flex"><div class="text" data-lang="rust">fn resize(mut v: Vec&lt;i32&gt;, new_size: usize) -&gt; Vec&lt;i32&gt; {
    v.resize(new_size, 0); // Ensures valid access
    v
}

</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe670" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe670"></a> <div class="content"><div class="flex"><div class="text">Rust’s ownership model ensures that after <markupcode>resize()</markupcode>, no aliasing occurs that could violate length constraints.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe671" class="block blockText textHeader3 align0"><a name="block-67acac980e5b17b32eebe671"></a> <div class="content"><div class="flex"><div class="text">Refinement Types for Runtime Length Constraints</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe672" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe672"></a> <div class="content"><div class="flex"><div class="text">Refinement type systems (like LiquidHaskell, F*, or refinement types in Rust’s <markupcode>prusti</markupcode>) allow specifying constraints on array lengths dynamically.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe673" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe673"></a> <div class="content"><div class="flex"><div class="text">Example in <markupbold>LiquidHaskell</markupbold>:</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe674" class="block blockText textCode align0"><a name="block-67acac980e5b17b32eebe674"></a> <div class="content"><div class="flex"><div class="text" data-lang="haskell">{-@ type ArrayN a N = {v:[a] | len v == N} @-}

{-@ safeIndex :: xs:ArrayN a n -&gt; {i:Nat | i &lt; n} -&gt; a @-}
safeIndex :: [a] -&gt; Int -&gt; a
safeIndex xs i = xs !! i

</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe675" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe675"></a> <div class="content"><div class="flex"><div class="text">This ensures <markupcode>safeIndex</markupcode> is only called with valid indices at runtime.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe676" class="block blockText textHeader3 align0"><a name="block-67acac980e5b17b32eebe676"></a> <div class="content"><div class="flex"><div class="text">Combining Linear &amp; Dependent Types</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe677" class="block blockText textParagraph align0"><a name="block-67acac980e5b17b32eebe677"></a> <div class="content"><div class="flex"><div class="text">Some modern systems (e.g., <markupbold>Granule</markupbold>) explore combining <markupbold>linear types</markupbold> (to track usage) and <markupbold>dependent types</markupbold> (to track lengths). This allows handling arrays with unknown lengths at compile time while ensuring safe indexing and transformations.</div></div></div><div class="children"></div></div><div id="67acac980e5b17b32eebe678" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe679" class="block blockText textHeader3 align0"><a name="block-67acac980e5b17b32eebe679"></a> <div class="content"><div class="flex"><div class="text">Conclusion</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe67a" class="block blockText textMarked align0"><a name="block-67acac980e5b17b32eebe67a"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupbold>Dependent types</markupbold> track exact lengths but require dependent pairs ( <markupcode>Σ</markupcode> types) for runtime reasoning.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe67b" class="block blockText textMarked align0"><a name="block-67acac980e5b17b32eebe67b"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupbold>Linear types</markupbold> ensure controlled mutation and safe resizing.</div></div></div><div class="children"></div></div><div id="block-67acac980e5b17b32eebe67c" class="block blockText textMarked align0"><a name="block-67acac980e5b17b32eebe67c"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupbold>Refinement types</markupbold> enforce runtime constraints while allowing verification.</div></div></div><div class="children"></div></div><div id="block-67acada90e5b17b32eebe690" class="block blockText textParagraph align0"><a name="block-67acada90e5b17b32eebe690"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div><div id="block-67acadaa0e5b17b32eebe691" class="block blockText textHeader2 align0"><a name="block-67acadaa0e5b17b32eebe691"></a> <div class="content"><div class="flex"><div class="text">Links</div></div></div><div class="children"></div></div><div id="block-67acacf10e5b17b32eebe682" class="block blockText textParagraph align0"><a name="block-67acacf10e5b17b32eebe682"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div><div id="block-67acad150e5b17b32eebe687" class="block blockBookmark"><div class="content"><a href="https://research.metastate.dev/a-gentle-introduction-to-dependent-types/" target="_blank" class="inner withImage"><div class="side left"><div class="link"><img src="https://anytype-prod-publishserver.s3.eu-central-2.amazonaws.com/67accb61888bdb1bed39e762/files/research_metastate_dev_icon.png" class="fav"> research.metastate.dev</div><div class="name">A Gentle Introduction to Dependent Types | PLT Research at METASTATE</div><div class="descr">Dependent types languages allow to enhance the expressiveness of your code, thereby increasing the errors the compiler can catch (at compile time).</div></div><div class="side right"><img src="https://anytype-prod-publishserver.s3.eu-central-2.amazonaws.com/67accb61888bdb1bed39e762/files/research_metastate_dev_cover.jpg" class="img"></div></a></div></div><div id="block-67acad170e5b17b32eebe688" class="block blockText textParagraph align2"><a name="block-67acad170e5b17b32eebe688"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div><div id="block-67acadbd0e5b17b32eebe692" class="block blockText textParagraph align2"><a name="block-67acadbd0e5b17b32eebe692"></a> <div class="content"><div class="flex"><div class="text"><markupitalic>juvix: Anoma smart contract language:</markupitalic></div></div></div><div class="children"></div></div><div id="block-67acad420e5b17b32eebe68b" class="block blockBookmark"><div class="content"><a href="https://docs.juvix.org/latest/README.html" target="_blank" class="inner"><div class="side left"><div class="link">docs.juvix.org</div><div class="name">Home - Juvix Docs</div><div class="descr">Juvix is a high-level programming language for writing privacy-preserving decentralised applications.</div></div></a></div></div></div></div><div id="block-div-67acbfaf0e5b17b32eebe736" class="block blockLayout layoutDiv align0" data-width="0.00"><div class="content"></div><div class="children"><div id="block-67acad720e5b17b32eebe68f" class="block blockText textParagraph align2"><a name="block-67acad720e5b17b32eebe68f"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div><div id="block-67acadbf0e5b17b32eebe693" class="block blockText textParagraph align2"><a name="block-67acadbf0e5b17b32eebe693"></a> <div class="content"><div class="flex"><div class="text"><markupitalic>Great book about creating dependent types I was reading/exercising some time ago:</markupitalic></div></div></div><div class="children"></div></div><div id="block-67acad6b0e5b17b32eebe68e" class="block blockBookmark"><div class="content"><a href="https://mitpress.mit.edu/9780262536431/the-little-typer/" target="_blank" class="inner"><div class="side left"><div class="link"><img src="https://anytype-prod-publishserver.s3.eu-central-2.amazonaws.com/67accb61888bdb1bed39e762/files/mitpress_mit_edu_icon.png" class="fav"> mitpress.mit.edu</div><div class="name">The Little Typer</div><div class="descr">A program&#39;s type describes its behavior. Dependent types are a first-class part of a language, and are much more powerful than other kinds of types; using ju...</div></div></a></div></div><div id="block-67acbfac0e5b17b32eebe695" class="block blockText textParagraph align0"><a name="block-67acbfac0e5b17b32eebe695"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div><div id="block-67acbfbf0e5b17b32eebe73e" class="block blockText textHeader1 align0"><a name="block-67acbfbf0e5b17b32eebe73e"></a> <div class="content"><div class="flex"><div class="text">APPENDIX A: How rust is related to linear and dependent types?</div></div></div><div class="children"></div></div><div id="block-67acbfcd0e5b17b32eebe741" class="block blockText textParagraph align0"><a name="block-67acbfcd0e5b17b32eebe741"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe716" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe716"></a> <div class="content"><div class="flex"><div class="text">The relationship between <markupbold>array indexing in Rust</markupbold> and <markupbold>linear/dependent types</markupbold> comes down to how these type systems ensure <markupbold>safe memory access, tracking of lengths, and preventing invalid mutations</markupbold>. Let&#39;s break it down.</div></div></div><div class="children"></div></div><div id="67acbfaf0e5b17b32eebe717" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe718" class="block blockText textHeader2 align0"><a name="block-67acbfaf0e5b17b32eebe718"></a> <div class="content"><div class="flex"><div class="text">Linear Types and Safe Indexing in Rust</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe719" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe719"></a> <div class="content"><div class="flex"><div class="text">Rust&#39;s <markupbold>ownership system</markupbold> and <markupbold>borrowing rules</markupbold> behave similarly to <markupbold>linear types</markupbold>, ensuring that:</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe71a" class="block blockText textMarked align0"><a name="block-67acbfaf0e5b17b32eebe71a"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">A value <markupbold>must be used exactly once</markupbold> (or explicitly shared via references).</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe71b" class="block blockText textMarked align0"><a name="block-67acbfaf0e5b17b32eebe71b"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">No aliasing issues occur that could lead to <markupbold>memory safety violations</markupbold>.</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe71c" class="block blockText textHeader3 align0"><a name="block-67acbfaf0e5b17b32eebe71c"></a> <div class="content"><div class="flex"><div class="text">How This Relates to Indexing</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe71d" class="block blockText textMarked align0"><a name="block-67acbfaf0e5b17b32eebe71d"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">When you pass a <markupcode>Vec&lt;T&gt;</markupcode> by value ( <markupcode>fn take_vec(v: Vec&lt;T&gt;)</markupcode>), Rust ensures the vector <markupbold>cannot be accessed again</markupbold> after being moved.</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe71e" class="block blockText textMarked align0"><a name="block-67acbfaf0e5b17b32eebe71e"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">When you pass a reference ( <markupcode>&amp;Vec&lt;T&gt;</markupcode> or <markupcode>&amp;mut Vec&lt;T&gt;</markupcode>), Rust enforces <markupbold>safe access</markupbold> rules to prevent data races.</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe71f" class="block blockText textHeader3 align0"><a name="block-67acbfaf0e5b17b32eebe71f"></a> <div class="content"><div class="flex"><div class="text">Example: Linear-Type-Like Behavior in Rust</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe720" class="block blockText textCode align0"><a name="block-67acbfaf0e5b17b32eebe720"></a> <div class="content"><div class="flex"><div class="text" data-lang="rust">fn main() {
    let mut v = vec![1, 2, 3];
    let first = &amp;v[0]; // Immutable borrow

    v.push(4); // ERROR: Cannot mutate while `first` exists
    println!(&#34;{}&#34;, first);
}

</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe721" class="block blockText textMarked align0"><a name="block-67acbfaf0e5b17b32eebe721"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">Rust prevents modifying <markupcode>v</markupcode> while <markupcode>first</markupcode> is borrowed, just like <markupbold>linear types</markupbold> prevent aliasing that could lead to unsafe access.</div></div></div><div class="children"></div></div><div id="67acbfaf0e5b17b32eebe722" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe723" class="block blockText textHeader2 align0"><a name="block-67acbfaf0e5b17b32eebe723"></a> <div class="content"><div class="flex"><div class="text">Dependent Types and Length-Safe Indexing</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe724" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe724"></a> <div class="content"><div class="flex"><div class="text">A <markupbold>dependent type system</markupbold> can encode constraints like &#34;this index is always within bounds.&#34; Rust doesn’t have dependent types, but <markupbold>some Rust-like solutions exist</markupbold>:</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe725" class="block blockText textHeader3 align0"><a name="block-67acbfaf0e5b17b32eebe725"></a> <div class="content"><div class="flex"><div class="text">Simulating Dependent Types with arrayvec</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe726" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe726"></a> <div class="content"><div class="flex"><div class="text">The <a href="https://docs.rs/arrayvec/latest/arrayvec/" class="markuplink" target="_blank"><markupcode>arrayvec</markupcode></a> crate provides <markupbold>fixed-size arrays</markupbold> with a known length at compile-time:</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe727" class="block blockText textCode align0"><a name="block-67acbfaf0e5b17b32eebe727"></a> <div class="content"><div class="flex"><div class="text" data-lang="rust">use arrayvec::ArrayVec;

fn main() {
    let mut v: ArrayVec&lt;[i32; 4]&gt; = ArrayVec::new();
    v.push(10);
    println!(&#34;{}&#34;, v[0]); // Safe access
}

</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe728" class="block blockText textMarked align0"><a name="block-67acbfaf0e5b17b32eebe728"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The compiler <markupbold>knows the length</markupbold>, preventing out-of-bounds access.</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe729" class="block blockText textMarked align0"><a name="block-67acbfaf0e5b17b32eebe729"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">This mimics <markupbold>dependent typing</markupbold> by enforcing array bounds at compile time.</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe72a" class="block blockText textHeader3 align0"><a name="block-67acbfaf0e5b17b32eebe72a"></a> <div class="content"><div class="flex"><div class="text">Using generic-array for Compile-Time Lengths</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe72b" class="block blockText textCode align0"><a name="block-67acbfaf0e5b17b32eebe72b"></a> <div class="content"><div class="flex"><div class="text" data-lang="rust">use generic_array::{arr, typenum::U3};

fn main() {
    let v = arr![1, 2, 3]; // Known at compile-time
    println!(&#34;{}&#34;, v[2]);   // Always safe
}

</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe72c" class="block blockText textMarked align0"><a name="block-67acbfaf0e5b17b32eebe72c"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The type system ensures the length is <markupbold>statically known</markupbold>, just like dependent types.</div></div></div><div class="children"></div></div><div id="67acbfaf0e5b17b32eebe72d" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe72e" class="block blockText textHeader2 align0"><a name="block-67acbfaf0e5b17b32eebe72e"></a> <div class="content"><div class="flex"><div class="text">Could Rust Have Built-in Dependent or Linear Types?</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe72f" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe72f"></a> <div class="content"><div class="flex"><div class="text">Rust doesn’t have <markupbold>true dependent types</markupbold>, but with const generics ( <markupcode>Vec&lt;T, const N: usize&gt;</markupcode>) evolving, it might get closer.</div></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe730" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe730"></a> <div class="content"><div class="flex"><div class="text">Linear types are already <markupbold>partially enforced</markupbold> through ownership and borrowing. If Rust added <markupbold>explicit linear types</markupbold>, it could prevent some unsafe cases automatically.</div></div></div><div class="children"></div></div><div id="67acbfaf0e5b17b32eebe731" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acbfaf0e5b17b32eebe714" class="block blockTable"><div class="content"><div class="scrollWrap"><div class="inner"><div id="table-67acbfaf0e5b17b32eebe714" class="table"><div class="rows"><div id="row-67acbfaf0e5b17b32eebe70e" class="row isHeader" style="grid-template-columns:140px 237px 247px;"><div id="cell-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70a" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70a" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70a"></a> <div class="content"><div class="flex"><div class="text">Feature</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70b" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70b" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70b"></a> <div class="content"><div class="flex"><div class="text">Rust’s Solution</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70c" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70c" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe70e-67acbfaf0e5b17b32eebe70c"></a> <div class="content"><div class="flex"><div class="text">Linear/Dependent Type Equivalent</div></div></div><div class="children"></div></div></div></div><div id="row-67acbfaf0e5b17b32eebe70f" class="row" style="grid-template-columns:140px 237px 247px;"><div id="cell-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70a" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70a" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70a"></a> <div class="content"><div class="flex"><div class="text">Prevent use-after-move</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70b" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70b" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70b"></a> <div class="content"><div class="flex"><div class="text">Ownership ( <markupcode>Vec&lt;T&gt;</markupcode> is moved)</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70c" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70c" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe70f-67acbfaf0e5b17b32eebe70c"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Linear Types</markupbold> (used once)</div></div></div><div class="children"></div></div></div></div><div id="row-67acbfaf0e5b17b32eebe710" class="row" style="grid-template-columns:140px 237px 247px;"><div id="cell-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70a" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70a" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70a"></a> <div class="content"><div class="flex"><div class="text">Prevent data races</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70b" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70b" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70b"></a> <div class="content"><div class="flex"><div class="text">Borrow checker ( <markupcode>&amp;Vec&lt;T&gt;</markupcode>, <markupcode>&amp;mut Vec&lt;T&gt;</markupcode>)</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70c" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70c" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe710-67acbfaf0e5b17b32eebe70c"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Linear Types</markupbold> (no aliasing)</div></div></div><div class="children"></div></div></div></div><div id="row-67acbfaf0e5b17b32eebe711" class="row" style="grid-template-columns:140px 237px 247px;"><div id="cell-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70a" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70a" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70a"></a> <div class="content"><div class="flex"><div class="text">Ensure index safety</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70b" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70b" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70b"></a> <div class="content"><div class="flex"><div class="text">Bounds checking ( <markupcode>v[index]</markupcode>, <markupcode>v.get()</markupcode>)</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70c" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70c" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe711-67acbfaf0e5b17b32eebe70c"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Dependent Types</markupbold> (length tracking)</div></div></div><div class="children"></div></div></div></div><div id="row-67acbfaf0e5b17b32eebe712" class="row" style="grid-template-columns:140px 237px 247px;"><div id="cell-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70a" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70a" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70a"></a> <div class="content"><div class="flex"><div class="text">Encode known lengths</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70b" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70b" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70b"></a> <div class="content"><div class="flex"><div class="text"><markupcode>arrayvec</markupcode>, <markupcode>generic-array</markupcode> (const generics)</div></div></div><div class="children"></div></div></div><div id="cell-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70c" class="cell align-h0 align-v0"><div id="block-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70c" class="block blockText textParagraph align0"><a name="block-67acbfaf0e5b17b32eebe712-67acbfaf0e5b17b32eebe70c"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Dependent Types</markupbold> (length in type)</div></div></div><div class="children"></div></div></div></div></div></div></div></div></div></div><div id="block-67acbfaf0e5b17b32eebe733" class="block blockText textHeader1 align0"><a name="block-67acbfaf0e5b17b32eebe733"></a> <div class="content"><div class="flex"><div class="text">APPENDIX B: Existential types</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7d5" class="block blockText textHeader3 align0"><a name="block-67acc0a00e5b17b32eebe7d5"></a> <div class="content"><div class="flex"><div class="text">Existential Quantification: What Is It?</div></div></div><div class="children"></div></div></div></div><div id="block-div-67acc0a00e5b17b32eebe7fd" class="block blockLayout layoutDiv align0" data-width="0.00"><div class="content"></div><div class="children"><div id="block-67acc0a00e5b17b32eebe7d6" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7d6"></a> <div class="content"><div class="flex"><div class="text">Existential quantification is a concept from logic and type theory that expresses <markupbold>&#34;there exists a type or value that satisfies some property, but we don’t know exactly what it is.&#34;</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7d7" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7d7"></a> <div class="content"><div class="flex"><div class="text">In programming languages, <markupbold>existential types</markupbold> allow us to abstract over some details while still enforcing constraints.</div></div></div><div class="children"></div></div><div id="67acc0a00e5b17b32eebe7d8" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7d9" class="block blockText textHeader3 align0"><a name="block-67acc0a00e5b17b32eebe7d9"></a> <div class="content"><div class="flex"><div class="text">Existential Quantification in Type Theory</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7da" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7da"></a> <div class="content"><div class="flex"><div class="text">In <markupbold>formal notation</markupbold>, existential quantification is written as:</div></div></div><div class="children"></div></div><div id="block-67acc2650e5b17b32eebe8fd" class="block blockEmbed isLatex align0"><div class="content">∃x.P(x)\exists x. P(x)
</div></div><div id="block-67acc0a00e5b17b32eebe7dc" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7dc"></a> <div class="content"><div class="flex"><div class="text">This means &#34;there exists some value <markupcode>x</markupcode> such that <markupbold><markupcode>P(x)</markupcode></markupbold><markupbold> is true.&#34;</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7dd" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7dd"></a> <div class="content"><div class="flex"><div class="text">Contrast this with <markupbold>universal quantification</markupbold> ( <markupcode>∀x. P(x)</markupcode>), which means &#34;for all values <markupcode>x</markupcode>, <markupbold><markupcode>P(x)</markupcode></markupbold><markupbold> is true.&#34;</markupbold></div></div></div><div class="children"></div></div><div id="67acc0a00e5b17b32eebe7de" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7df" class="block blockText textHeader3 align0"><a name="block-67acc0a00e5b17b32eebe7df"></a> <div class="content"><div class="flex"><div class="text">Existential Types in Programming</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e0" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7e0"></a> <div class="content"><div class="flex"><div class="text">In programming, <markupbold>existential types</markupbold> allow us to hide <markupbold>some part of a type</markupbold>. This is useful for <markupbold>abstracting implementation details</markupbold> while enforcing constraints.</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e1" class="block blockText textHeader3 align0"><a name="block-67acc0a00e5b17b32eebe7e1"></a> <div class="content"><div class="flex"><div class="text">Example: Existential Quantification in Rust (Trait Objects)</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e2" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7e2"></a> <div class="content"><div class="flex"><div class="text">Rust doesn&#39;t have true existential types, but trait objects ( <markupbold><markupcode>dyn Trait</markupcode></markupbold><markupbold>)</markupbold> behave similarly:</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e3" class="block blockText textCode align0"><a name="block-67acc0a00e5b17b32eebe7e3"></a> <div class="content"><div class="flex"><div class="text" data-lang="rust">trait Shape {
    fn area(&amp;self) -&gt; f64;
}

// The function returns &#34;some Shape&#34;, but we don’t know which one (existential)
fn get_shape() -&gt; Box&lt;dyn Shape&gt; {
    struct Circle { radius: f64 }
    impl Shape for Circle {
        fn area(&amp;self) -&gt; f64 {
            3.14 * self.radius * self.radius
        }
    }

    Box::new(Circle { radius: 5.0 }) // Returns a shape, but hides its concrete type
}

</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e4" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7e4"></a> <div class="content"><div class="flex"><div class="text">Here, <markupcode>Box&lt;dyn Shape&gt;</markupcode> means &#34;there exists some type that implements <markupbold><markupcode>Shape</markupcode></markupbold><markupbold>, but we don&#39;t specify which.&#34;</markupbold></div></div></div><div class="children"></div></div><div id="67acc0a00e5b17b32eebe7e5" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e6" class="block blockText textHeader3 align0"><a name="block-67acc0a00e5b17b32eebe7e6"></a> <div class="content"><div class="flex"><div class="text">Existential Quantification and Arrays of Unknown Length</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e7" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7e7"></a> <div class="content"><div class="flex"><div class="text">When reasoning about array lengths in a <markupbold>dependent or linear type system</markupbold>, we sometimes need to express:</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e8" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7e8"></a> <div class="content"><div class="flex"><div class="text">&#34;There exists an <markupcode>n</markupcode> such that this array has length <markupcode>n</markupcode>, but we don&#39;t know <markupbold><markupcode>n</markupcode></markupbold><markupbold> at compile time.&#34;</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7e9" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7e9"></a> <div class="content"><div class="flex"><div class="text">This is where <markupbold>existential types</markupbold> come in.</div></div></div><div class="children"></div></div></div></div><div id="block-div-67acc14a0e5b17b32eebe8f7" class="block blockLayout layoutDiv align0" data-width="0.00"><div class="content"></div><div class="children"><div id="block-67acc0a00e5b17b32eebe7ea" class="block blockText textHeader3 align0"><a name="block-67acc0a00e5b17b32eebe7ea"></a> <div class="content"><div class="flex"><div class="text">Example in Idris (Explicit Existential Types)</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7eb" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7eb"></a> <div class="content"><div class="flex"><div class="text">Idris (a dependently typed language) allows existential quantification using Sigma types ( <markupbold><markupcode>Σ</markupcode></markupbold><markupbold>)</markupbold>:</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7ec" class="block blockText textCode align0"><a name="block-67acc0a00e5b17b32eebe7ec"></a> <div class="content"><div class="flex"><div class="text" data-lang="idris">getArray : IO (n ** Vect n Int)

</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7ed" class="block blockText textMarked align0"><a name="block-67acc0a00e5b17b32eebe7ed"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The <markupcode>n ** Vect n Int</markupcode> part means &#34;there exists an <markupbold><markupcode>n</markupcode></markupbold><markupbold>, and we return a vector of that length.&#34;</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7ee" class="block blockText textMarked align0"><a name="block-67acc0a00e5b17b32eebe7ee"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The caller does not know <markupcode>n</markupcode> in advance, but the system guarantees safety.</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7ef" class="block blockText textHeader3 align0"><a name="block-67acc0a00e5b17b32eebe7ef"></a> <div class="content"><div class="flex"><div class="text">Rust Equivalent (Tuple as Existential Pair)</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7f0" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7f0"></a> <div class="content"><div class="flex"><div class="text">Since Rust lacks dependent types, you can return a tuple:</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7f1" class="block blockText textCode align0"><a name="block-67acc0a00e5b17b32eebe7f1"></a> <div class="content"><div class="flex"><div class="text" data-lang="rust">fn get_array() -&gt; (usize, Vec&lt;i32&gt;) {
    let arr = vec![1, 2, 3, 4];
    (arr.len(), arr)
}

</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7f2" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7f2"></a> <div class="content"><div class="flex"><div class="text">This simulates &#34;there exists some <markupbold><markupcode>n</markupcode></markupbold><markupbold>, and we return an array of that length.&#34;</markupbold> The caller knows <markupcode>n</markupcode><markupbold>only after runtime</markupbold>.</div></div></div><div class="children"></div></div><div id="67acc0a00e5b17b32eebe7f3" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7d3" class="block blockTable"><div class="content"><div class="scrollWrap"><div class="inner"><div id="table-67acc0a00e5b17b32eebe7d3" class="table"><div class="rows"><div id="row-67acc0a00e5b17b32eebe7cd" class="row isHeader" style="grid-template-columns:140px 234px 212px;"><div id="cell-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7c9" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7c9" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7c9"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Feature</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7ca" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7ca" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7ca"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Example</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7cb" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7cb" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7cd-67acc0a00e5b17b32eebe7cb"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Interpretation</markupbold></div></div></div><div class="children"></div></div></div></div><div id="row-67acc0a00e5b17b32eebe7ce" class="row" style="grid-template-columns:140px 234px 212px;"><div id="cell-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7c9" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7c9" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7c9"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Existential Quantification</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7ca" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7ca" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7ca"></a> <div class="content"><div class="flex"><div class="text"><markupcode>∃n. Array(n)</markupcode></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7cb" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7cb" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7ce-67acc0a00e5b17b32eebe7cb"></a> <div class="content"><div class="flex"><div class="text">&#34;There exists some <markupcode>n</markupcode>.&#34;</div></div></div><div class="children"></div></div></div></div><div id="row-67acc0a00e5b17b32eebe7cf" class="row" style="grid-template-columns:140px 234px 212px;"><div id="cell-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7c9" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7c9" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7c9"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Universal Quantification</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7ca" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7ca" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7ca"></a> <div class="content"><div class="flex"><div class="text"><markupcode>∀n. Array(n) -&gt; n &gt; 0</markupcode></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7cb" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7cb" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7cf-67acc0a00e5b17b32eebe7cb"></a> <div class="content"><div class="flex"><div class="text">&#34;For all <markupcode>n</markupcode>, array must be non-empty.&#34;</div></div></div><div class="children"></div></div></div></div><div id="row-67acc0a00e5b17b32eebe7d0" class="row" style="grid-template-columns:140px 234px 212px;"><div id="cell-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7c9" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7c9" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7c9"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Rust&#39;s Approximation</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7ca" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7ca" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7ca"></a> <div class="content"><div class="flex"><div class="text"><markupcode>Box&lt;dyn Trait&gt;</markupcode>, <markupcode>(usize, Vec&lt;T&gt;)</markupcode></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7cb" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7cb" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7d0-67acc0a00e5b17b32eebe7cb"></a> <div class="content"><div class="flex"><div class="text">&#34;We don&#39;t know the exact type/size at compile time.&#34;</div></div></div><div class="children"></div></div></div></div><div id="row-67acc0a00e5b17b32eebe7d1" class="row" style="grid-template-columns:140px 234px 212px;"><div id="cell-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7c9" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7c9" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7c9"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Dependent Type Example</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7ca" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7ca" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7ca"></a> <div class="content"><div class="flex"><div class="text"><markupcode>(n ** Vect n Int)</markupcode> in Idris</div></div></div><div class="children"></div></div></div><div id="cell-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7cb" class="cell align-h0 align-v0"><div id="block-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7cb" class="block blockText textParagraph align0"><a name="block-67acc0a00e5b17b32eebe7d1-67acc0a00e5b17b32eebe7cb"></a> <div class="content"><div class="flex"><div class="text">&#34;There exists an <markupcode>n</markupcode> that determines vector length.&#34;</div></div></div><div class="children"></div></div></div></div></div></div></div></div></div></div><div id="block-67acc0a00e5b17b32eebe7f7" class="block blockText textMarked align0"><a name="block-67acc0a00e5b17b32eebe7f7"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupbold>Existential types hide information</markupbold> while still enforcing constraints.</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7f8" class="block blockText textMarked align0"><a name="block-67acc0a00e5b17b32eebe7f8"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">Trait objects ( <markupbold><markupcode>dyn Trait</markupcode></markupbold><markupbold>)</markupbold> and tuples in Rust behave similarly.</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7f9" class="block blockText textMarked align0"><a name="block-67acc0a00e5b17b32eebe7f9"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">Dependent types (like Idris&#39;s <markupbold><markupcode>Σ</markupcode></markupbold><markupbold> types)</markupbold> express existential quantification explicitly.</div></div></div><div class="children"></div></div><div id="block-67acc0a00e5b17b32eebe7fa" class="block blockText textMarked align0"><a name="block-67acc0a00e5b17b32eebe7fa"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupbold>This is useful for reasoning about arrays with unknown sizes at compile time.</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc17d0e5b17b32eebe8fa" class="block blockText textParagraph align0"><a name="block-67acc17d0e5b17b32eebe8fa"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8be" class="block blockText textHeader2 align0"><a name="block-67acc14a0e5b17b32eebe8be"></a> <div class="content"><div class="flex"><div class="text">Existential Types in Dependent Typed Languages</div></div></div><div class="children"></div></div><div id="block-67acc1770e5b17b32eebe8f9" class="block blockText textParagraph align0"><a name="block-67acc1770e5b17b32eebe8f9"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8bf" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8bf"></a> <div class="content"><div class="flex"><div class="text">In <markupbold>dependent type systems</markupbold>, existential types express that <markupbold>&#34;there exists a value of some type that satisfies a given property&#34;</markupbold> without exposing the exact value. This is often encoded using <markupbold>Σ-types (Sigma types)</markupbold>, which pair a value with a proof that it satisfies some property.</div></div></div><div class="children"></div></div><div id="67acc14a0e5b17b32eebe8c0" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8c1" class="block blockText textHeader2 align0"><a name="block-67acc14a0e5b17b32eebe8c1"></a> <div class="content"><div class="flex"><div class="text">Existential Types vs. Universal Types</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8c2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8c2"></a> <div class="content"><div class="flex"><div class="text">Before diving in, let&#39;s contrast <markupbold>existential quantification</markupbold> ( <markupcode>∃</markupcode>) with <markupbold>universal quantification</markupbold> ( <markupcode>∀</markupcode>):</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8c3" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8c3"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">Universal ( <markupbold><markupcode>∀x. P(x)</markupcode></markupbold><markupbold>)</markupbold> → &#34;For all values <markupcode>x</markupcode>, property <markupcode>P(x)</markupcode> holds.&#34;</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8c4" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8c4"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">Existential ( <markupbold><markupcode>∃x. P(x)</markupcode></markupbold><markupbold>)</markupbold> → &#34;There exists some <markupcode>x</markupcode> such that <markupcode>P(x)</markupcode> holds, but we don’t necessarily know <markupcode>x</markupcode>.&#34;</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8c5" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8c5"></a> <div class="content"><div class="flex"><div class="text">For example, if we want to express &#34;there exists a natural number <markupcode>n</markupcode> such that <markupcode>n &gt; 3</markupcode>,&#34; we write:</div></div></div><div class="children"></div></div><div id="block-67acc3d30e5b17b32eebe8ff" class="block blockEmbed isLatex align0"><div class="content">∃n:N, n>3\exists n : \mathbb{N},\ n > 3</div></div><div id="67acc14a0e5b17b32eebe8c7" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8c8" class="block blockText textHeader2 align0"><a name="block-67acc14a0e5b17b32eebe8c8"></a> <div class="content"><div class="flex"><div class="text">Existential Types in Dependent Languages</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8c9" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8c9"></a> <div class="content"><div class="flex"><div class="text">Many dependently typed languages, such as <markupbold>Agda, Idris, and Coq</markupbold>, use <markupbold>Σ-types</markupbold> ( <markupcode>Sigma types</markupcode>) to express existential quantification.</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8ca" class="block blockText textHeader3 align0"><a name="block-67acc14a0e5b17b32eebe8ca"></a> <div class="content"><div class="flex"><div class="text">Example: Existential Types in Idris</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8cb" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8cb"></a> <div class="content"><div class="flex"><div class="text">In <markupbold>Idris</markupbold>, we can define an existential type for &#34;an array with some unknown but valid length.&#34;</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8cc" class="block blockText textCode align0"><a name="block-67acc14a0e5b17b32eebe8cc"></a> <div class="content"><div class="flex"><div class="text" data-lang="idris">data ExistsLength : Type -&gt; Type where
    MkExistsLength : (n : Nat) -&gt; Vect n a -&gt; ExistsLength a

</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8cd" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8cd"></a> <div class="content"><div class="flex"><div class="text">This defines an existential wrapper for vectors:</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8ce" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8ce"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupcode>n : Nat</markupcode> is the <markupbold>existentially quantified length</markupbold>.</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8cf" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8cf"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The vector itself has length <markupcode>n</markupcode>, but the caller doesn&#39;t know <markupcode>n</markupcode> upfront.</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8d0" class="block blockText textHeader3 align0"><a name="block-67acc14a0e5b17b32eebe8d0"></a> <div class="content"><div class="flex"><div class="text">Usage Example</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8d1" class="block blockText textCode align0"><a name="block-67acc14a0e5b17b32eebe8d1"></a> <div class="content"><div class="flex"><div class="text" data-lang="idris">getArray : ExistsLength Int
getArray = MkExistsLength 3 [1, 2, 3]

</div></div></div><div class="children"></div></div></div></div><div id="block-div-67acc14a0e5b17b32eebe8f8" class="block blockLayout layoutDiv align0" data-width="0.00"><div class="content"></div><div class="children"><div id="block-67acc14a0e5b17b32eebe8d2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8d2"></a> <div class="content"><div class="flex"><div class="text">Here, <markupcode>getArray</markupcode> returns a vector, but its length is <markupbold>hidden inside the existential type</markupbold>.</div></div></div><div class="children"></div></div><div id="67acc14a0e5b17b32eebe8d3" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8d4" class="block blockText textHeader2 align0"><a name="block-67acc14a0e5b17b32eebe8d4"></a> <div class="content"><div class="flex"><div class="text">Existential Types for Safe Runtime-Length Arrays</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8d5" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8d5"></a> <div class="content"><div class="flex"><div class="text">A common use case of existential types in dependent typing is ensuring <markupbold>length safety at runtime</markupbold> while still allowing dynamic behavior.</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8d6" class="block blockText textHeader3 align0"><a name="block-67acc14a0e5b17b32eebe8d6"></a> <div class="content"><div class="flex"><div class="text">Example: Safely Constructing a Length-Unknown Array</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8d7" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8d7"></a> <div class="content"><div class="flex"><div class="text">Let&#39;s define a function that <markupbold>reads an array at runtime</markupbold> and returns its length safely.</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8d8" class="block blockText textCode align0"><a name="block-67acc14a0e5b17b32eebe8d8"></a> <div class="content"><div class="flex"><div class="text" data-lang="idris">readArray : IO (ExistsLength Int)
readArray = do
  putStr &#34;Enter a number of elements: &#34;
  len &lt;- getLine
  let n = cast len
  let vec = generate n (\i =&gt; i) -- Generates [0,1,2,...]
  pure (MkExistsLength n vec)

</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8d9" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8d9"></a> <div class="content"><div class="flex"><div class="text">Here:</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8da" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8da"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The length <markupcode>n</markupcode> is <markupbold>computed at runtime</markupbold>.</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8db" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8db"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The return type guarantees <markupcode>Vect n Int</markupcode>, so <markupbold>indexing is always safe</markupbold>.</div></div></div><div class="children"></div></div><div id="67acc14a0e5b17b32eebe8dc" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8dd" class="block blockText textHeader2 align0"><a name="block-67acc14a0e5b17b32eebe8dd"></a> <div class="content"><div class="flex"><div class="text">Existential Types in Coq (Σ-Types)</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8de" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8de"></a> <div class="content"><div class="flex"><div class="text">In <markupbold>Coq</markupbold>, existential types are represented using <markupbold>Σ-types</markupbold>, which pair a value with a proof.</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8df" class="block blockText textCode align0"><a name="block-67acc14a0e5b17b32eebe8df"></a> <div class="content"><div class="flex"><div class="text" data-lang="coq">Require Import Coq.Vectors.Vector.
Import VectorNotations.

(* Existential Type: A vector with some unknown length *)
Definition exists_vector (A : Type) : Type :=
  { n : nat &amp; t A n }.  (* Sigma type: ∃ n, vector of length n *)

</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e0" class="block blockText textHeader3 align0"><a name="block-67acc14a0e5b17b32eebe8e0"></a> <div class="content"><div class="flex"><div class="text">Example Usage in Coq</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e1" class="block blockText textCode align0"><a name="block-67acc14a0e5b17b32eebe8e1"></a> <div class="content"><div class="flex"><div class="text" data-lang="coq">Definition example_vector : exists_vector nat :=
  existT _ 3 [1; 2; 3].

</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8e2"></a> <div class="content"><div class="flex"><div class="text">This ensures that:</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e3" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8e3"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The vector has <markupbold>some</markupbold> length <markupcode>n</markupcode> (but <markupcode>n</markupcode> is abstracted away).</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e4" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8e4"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The vector is <markupbold>safe to use</markupbold> (never out-of-bounds).</div></div></div><div class="children"></div></div><div id="67acc14a0e5b17b32eebe8e5" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e6" class="block blockText textHeader2 align0"><a name="block-67acc14a0e5b17b32eebe8e6"></a> <div class="content"><div class="flex"><div class="text">How Existential Types Help with Arrays of Unknown Length</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e7" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8e7"></a> <div class="content"><div class="flex"><div class="text">When working with <markupbold>dynamically sized arrays</markupbold>, we often:</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e8" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8e8"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupbold>Track the length at runtime but enforce safety statically.</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8e9" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8e9"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupbold>Pass around arrays while hiding their exact size</markupbold> (existential quantification).</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8ea" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8ea"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text"><markupbold>Ensure safe indexing and transformations without runtime panics.</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8eb" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8eb"></a> <div class="content"><div class="flex"><div class="text">For example, if we want to safely <markupbold>concatenate two vectors of unknown size</markupbold>, we can:</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8ec" class="block blockText textNumbered align0"><a name="block-67acc14a0e5b17b32eebe8ec"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker number"><span class="markerInner c10">1.</span></div></div><div class="text"><markupbold>Unpack their existential types.</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8ed" class="block blockText textNumbered align0"><a name="block-67acc14a0e5b17b32eebe8ed"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker number"><span class="markerInner c10">2.</span></div></div><div class="text"><markupbold>Compute their new length.</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8ee" class="block blockText textNumbered align0"><a name="block-67acc14a0e5b17b32eebe8ee"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker number"><span class="markerInner c10">3.</span></div></div><div class="text"><markupbold>Construct a new vector while ensuring length correctness.</markupbold></div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8ef" class="block blockText textCode align0"><a name="block-67acc14a0e5b17b32eebe8ef"></a> <div class="content"><div class="flex"><div class="text" data-lang="idris">concatExists : ExistsLength a -&gt; ExistsLength a -&gt; ExistsLength a
concatExists (MkExistsLength n1 v1) (MkExistsLength n2 v2) =
    MkExistsLength (n1 + n2) (v1 ++ v2)

</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8f0" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8f0"></a> <div class="content"><div class="flex"><div class="text">Here, the <markupbold>type system guarantees</markupbold> that:</div></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8f1" class="block blockText textMarked align0"><a name="block-67acc14a0e5b17b32eebe8f1"></a> <div class="content"><div class="flex"><div class="markers"><div class="marker bullet"><span class="markerInner textColor-"></span></div></div><div class="text">The resulting vector has length <markupcode>n1 + n2</markupcode>, ensuring safe access.</div></div></div><div class="children"></div></div><div id="67acc14a0e5b17b32eebe8f2" class="block align0 blockDiv divLine"><div class="content"><div class="line"></div></div><div class="children"></div></div><div id="block-67acc14a0e5b17b32eebe8bc" class="block blockTable"><div class="content"><div class="scrollWrap"><div class="inner"><div id="table-67acc14a0e5b17b32eebe8bc" class="table"><div class="rows"><div id="row-67acc14a0e5b17b32eebe8b5" class="row isHeader" style="grid-template-columns:249px 356px;"><div id="cell-67acc14a0e5b17b32eebe8b5-67acc14a0e5b17b32eebe8b2" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b5-67acc14a0e5b17b32eebe8b2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b5-67acc14a0e5b17b32eebe8b2"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Concept</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc14a0e5b17b32eebe8b5-67acc14a0e5b17b32eebe8b3" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b5-67acc14a0e5b17b32eebe8b3" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b5-67acc14a0e5b17b32eebe8b3"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Description</markupbold></div></div></div><div class="children"></div></div></div></div><div id="row-67acc14a0e5b17b32eebe8b6" class="row" style="grid-template-columns:249px 356px;"><div id="cell-67acc14a0e5b17b32eebe8b6-67acc14a0e5b17b32eebe8b2" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b6-67acc14a0e5b17b32eebe8b2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b6-67acc14a0e5b17b32eebe8b2"></a> <div class="content"><div class="flex"><div class="text">Existential Type ( <markupbold><markupcode>∃x. P(x)</markupcode></markupbold><markupbold>)</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc14a0e5b17b32eebe8b6-67acc14a0e5b17b32eebe8b3" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b6-67acc14a0e5b17b32eebe8b3" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b6-67acc14a0e5b17b32eebe8b3"></a> <div class="content"><div class="flex"><div class="text">&#34;There exists an <markupcode>x</markupcode> such that <markupcode>P(x)</markupcode> holds.&#34;</div></div></div><div class="children"></div></div></div></div><div id="row-67acc14a0e5b17b32eebe8b7" class="row" style="grid-template-columns:249px 356px;"><div id="cell-67acc14a0e5b17b32eebe8b7-67acc14a0e5b17b32eebe8b2" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b7-67acc14a0e5b17b32eebe8b2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b7-67acc14a0e5b17b32eebe8b2"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Σ-Types (Sigma Types)</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc14a0e5b17b32eebe8b7-67acc14a0e5b17b32eebe8b3" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b7-67acc14a0e5b17b32eebe8b3" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b7-67acc14a0e5b17b32eebe8b3"></a> <div class="content"><div class="flex"><div class="text">Pair a value with a proof ( <markupcode>Σ (x : A), P(x)</markupcode>).</div></div></div><div class="children"></div></div></div></div><div id="row-67acc14a0e5b17b32eebe8b8" class="row" style="grid-template-columns:249px 356px;"><div id="cell-67acc14a0e5b17b32eebe8b8-67acc14a0e5b17b32eebe8b2" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b8-67acc14a0e5b17b32eebe8b2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b8-67acc14a0e5b17b32eebe8b2"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Used for Length-Safe Arrays</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc14a0e5b17b32eebe8b8-67acc14a0e5b17b32eebe8b3" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b8-67acc14a0e5b17b32eebe8b3" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b8-67acc14a0e5b17b32eebe8b3"></a> <div class="content"><div class="flex"><div class="text">Ensures indexing is always safe.</div></div></div><div class="children"></div></div></div></div><div id="row-67acc14a0e5b17b32eebe8b9" class="row" style="grid-template-columns:249px 356px;"><div id="cell-67acc14a0e5b17b32eebe8b9-67acc14a0e5b17b32eebe8b2" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b9-67acc14a0e5b17b32eebe8b2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b9-67acc14a0e5b17b32eebe8b2"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Example in Idris</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc14a0e5b17b32eebe8b9-67acc14a0e5b17b32eebe8b3" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8b9-67acc14a0e5b17b32eebe8b3" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8b9-67acc14a0e5b17b32eebe8b3"></a> <div class="content"><div class="flex"><div class="text"><markupcode>MkExistsLength : (n : Nat) -&gt; Vect n a -&gt; ExistsLength a</markupcode></div></div></div><div class="children"></div></div></div></div><div id="row-67acc14a0e5b17b32eebe8ba" class="row" style="grid-template-columns:249px 356px;"><div id="cell-67acc14a0e5b17b32eebe8ba-67acc14a0e5b17b32eebe8b2" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8ba-67acc14a0e5b17b32eebe8b2" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8ba-67acc14a0e5b17b32eebe8b2"></a> <div class="content"><div class="flex"><div class="text"><markupbold>Example in Coq</markupbold></div></div></div><div class="children"></div></div></div><div id="cell-67acc14a0e5b17b32eebe8ba-67acc14a0e5b17b32eebe8b3" class="cell align-h0 align-v0"><div id="block-67acc14a0e5b17b32eebe8ba-67acc14a0e5b17b32eebe8b3" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8ba-67acc14a0e5b17b32eebe8b3"></a> <div class="content"><div class="flex"><div class="text"><markupcode>{ n : nat &amp; Vector.t A n }</markupcode></div></div></div><div class="children"></div></div></div></div></div></div></div></div></div></div><div id="block-67acc14a0e5b17b32eebe8f4" class="block blockText textParagraph align0"><a name="block-67acc14a0e5b17b32eebe8f4"></a> <div class="content"><div class="flex"><div class="text">Existential types allow <markupbold>safe reasoning about dynamically sized arrays</markupbold> without losing the power of static guarantees.</div></div></div><div class="children"></div></div></div></div><div id="block-67acbfde0e5b17b32eebe742" class="block blockText textParagraph align0"><a name="block-67acbfde0e5b17b32eebe742"></a> <div class="content"><div class="flex"><div class="text"></div></div></div><div class="children"></div></div></div></div><footer class="footer"><a href="https://anytype.io/" target="_blank" class="button c36 fathom" data-event="PublishSiteClick"><div class="icon"></div><div class="text">Crafted with Anytype</div></a></footer></main><script src="/static/js/loader.js" type="text/javascript"></script><script>console.log("sending dummy analytics...")</script></body></html>